from yahoofinancials import YahooFinancials
import csv
import ssl
ssl._create_default_https_context = ssl._create_unverified_context

ticker = []
with open("name.csv")as f:
    f_csv = csv.reader(f)
    for row in f_csv:
        ticker.append(row[0])
a = ['BRK.B', 'PARA', 'CEG', 'BF.B', 'V', 'XOM', 'CVX', 'WMT', 'MRK', 'T', 'UPS', 'BMY', 'NEE', 'CVS', 'ORCL', 'COP', 'BA', 'GE', 'DUK', 'F', 'SO', 'EOG', 'HUM', 'PXD', 'MRNA', 'NXPI', 'MPC', 'DOW', 'SRE', 'HLT', 'DD', 'DLR', 'PSX', 'CTVA', 'VLO', 'OXY', 'DVN', 'AMP', 'WBA', 'PEG', 'EXPE', 'HAL', 'TWTR', 'DAL', 'LUV', 'HES', 'BKR', 'ALB', 'EIX', 'FANG', 'ABC', 'RCL', 'CTRA', 'CCL', 'WDC', 'MRO', 'MGM', 'CZR', 'MOS', 'CF', 'UDR', 'CAH', 'LVS', 'UAL', 'LYV', 'KIM', 'AES', 'HST', 'INCY', 'RE', 'APA', 'AAL', 'NI', 'WYNN', 'AIZ', 'CDAY', 'DXC', 'PBCT', 'FRT', 'NCLH', 'ALK', 'RL']
for i in a:
    ticker.remove(i)

def PE_ratio(s):
    yahoo_financials = YahooFinancials(s)
    PE=yahoo_financials.get_pe_ratio()
    return PE

PE = {'AAPL': 26.770573, 'MSFT': 30.02131, 'AMZN': 45.038265, 'GOOGL': 22.905336, 'GOOG': 22.89981, 'TSLA': 157.72292, 'NVDA': 58.72208, 'FB': 14.50472, 'JPM': 9.695963, 'UNH': 25.490044, 'JNJ': 20.682459, 'PG': 27.618965, 'HD': 19.942049, 'BAC': 12.56591, 'MA': 41.174656, 'DIS': 86.92805, 'PFE': 12.1484165, 'ABBV': 22.76977, 'KO': 27.32, 'AVGO': 37.867332, 'CSCO': 19.467857, 'PEP': 30.378872, 'COST': 42.7687, 'WFC': 10.888889, 'VZ': 10.036661, 'ADBE': 43.252495, 'CMCSA': 14.868422, 'ABT': 29.784264, 'TMO': 27.252316, 'ACN': 32.718716, 'CRM': 105.17877, 'INTC': 9.22428, 'LLY': 38.947712, 'MCD': 24.657234, 'QCOM': 18.63626, 'AMD': 42.815178, 'NKE': 36.023624, 'PM': 18.572899, 'NFLX': 32.792706, 'DHR': 30.528027, 'UNP': 24.60001, 'LOW': 18.901196, 'LIN': 39.919506, 'TXN': 20.121065, 'RTX': 36.14347, 'INTU': 62.134285, 'MS': 11.627647, 'MDT': 29.7376, 'SCHW': 29.204948, 'C': 6.23287, 'HON': 22.661188, 'AMGN': 21.504866, 'PYPL': 28.713068, 'AMAT': 17.928682, 'AXP': 18.862774, 'GS': 5.729016, 'NOW': 464.57083, 'IBM': 19.223501, 'ANTM': 17.95633, 'SBUX': 24.23264, 'BLK': 19.181318, 'DE': 18.671131, 'BKNG': 266.57947, 'PLD': 35.8141, 'CAT': 15.792055, 'MU': 13.556725, 'AMT': 41.30198, 'ISRG': 59.298283, 'TGT': 14.026644, 'LMT': 17.101933, 'MO': 38.8503, 'MDLZ': 21.822367, 'SPGI': 30.002396, 'ZTS': 43.840984, 'CB': 10.476647, 'ADI': 54.027157, 'MMM': 14.256917, 'CME': 32.369, 'PNC': 15.681102, 'ADP': 30.481115, 'SYK': 48.596928, 'TFC': 13.5850115, 'LRCX': 16.955492, 'TJX': 28.619059, 'CSX': 19.889883, 'USB': 11.098039, 'GILD': 12.44929, 'MMC': 24.347471, 'BDX': 46.646404, 'CI': 14.334711, 'CHTR': 23.3554, 'TMUS': 50.481327, 'GM': 6.941791, 'CCI': 63.44282, 'EL': 33.02181, 'ICE': 17.355154, 'CL': 30.888235, 'EW': 44.30252, 'NSC': 20.95706, 'REGN': 8.471029, 'COF': 5.546936, 'SHW': 37.156162, 'D': 19.530756, 'FCX': 14.610344, 'ATVI': 23.44622, 'ITW': 25.149237, 'EQIX': 121.79023, 'AON': 50.54414, 'PGR': 18.556538, 'BSX': 63.586956, 'ETN': 27.955055, 'HCA': 11.46172, 'NOC': 8.866789, 'FIS': 138.01492, 'VRTX': 25.744728, 'SLB': 30.06818, 'FISV': 46.782482, 'KLAC': 17.8379, 'EMR': 19.892965, 'WM': 32.843822, 'FDX': 11.863484, 'NEM': 26.909735, 'APD': 24.017876, 'PSA': 35.853596, 'MCO': 27.216469, 'AIG': 5.6996303, 'MET': 9.30985, 'ILMN': 62.66865, 'GD': 18.722078, 'ADSK': 35.598854, 'MAR': 50.314373, 'CNC': 35.776318, 'TEL': 18.795597, 'SPG': 19.694267, 'JCI': 29.14651, 'DG': 18.461538, 'ROP': 39.709957, 'ORLY': 20.199358, 'CTSH': 20.891357, 'APH': 28.94261, 'SNPS': 49.82669, 'ECL': 44.439896, 'KMB': 24.684113, 'MSCI': 59.06437, 'BK': 12.972223, 'LHX': 23.870115, 'IQV': 45.38788, 'PRU': 5.7018714, 'SYY': 55.148026, 'INFO': 35.205982, 'ADM': 15.707725, 'AEP': 17.820244, 'CMG': 62.348473, 'TRV': 11.78537, 'MCK': 29.856922, 'FTNT': 79.02754, 'HPQ': 6.491557, 'IDXX': 55.15581, 'BAX': 33.889328, 'GIS': 18.489527, 'EXC': 23.891811, 'GPN': 40.715805, 'AZO': 17.451666, 'MCHP': 41.4554, 'A': 32.350254, 'PH': 20.951145, 'AFL': 9.651017, 'APTV': 68.801544, 'CARR': 23.556149, 'CDNS': 56.536, 'O': 51.853313, 'DXCM': 243.4, 'PAYX': 32.33807, 'EA': 57.03371, 'ALGN': 50.03715, 'MSI': 29.069735, 'YUM': 23.401152, 'DFS': 6.74839, 'SIVB': 18.75152, 'WMB': 24.383064, 'STZ': None, 'TT': 25.390638, 'WELL': 103.871796, 'XEL': 21.988174, 'PPG': 23.503078, 'EBAY': 3.0058532, 'ALL': 24.91202, 'NUE': 5.132988, 'IFF': 121.359085, 'TDG': 50.28847, 'STT': 12.178024, 'RMD': 65.84412, 'CBRE': 22.459208, 'FITB': 12.680964, 'AVB': 32.788593, 'ROST': 19.724524, 'MTD': 42.487343, 'KMI': 21.815235, 'TROW': 10.588922, 'OTIS': 26.60593, 'PCAR': 18.263945, 'SBAC': 112.778206, 'CTAS': 34.156235, 'GLW': 40.154385, 'MTCH': 55.881104, 'AJG': 32.964085, 'CMI': 13.562881, 'BIIB': 20.649897, 'FRC': 22.531324, 'ROK': 22.323835, 'KR': 33.626415, 'VRSK': 41.411213, 'MNST': 27.838602, 'DLTR': 23.110905, 'KEYS': 32.334724, 'BLL': 36.532124, 'AME': 31.38346, 'FAST': 32.363636, 'HSY': 29.465738, 'WY': 11.24766, 'ANET': 47.84003, 'EQR': 29.805172, 'ED': 25.102194, 'WST': 44.637234, 'ES': 23.259674, 'WEC': 21.322891, 'OKE': 19.067293, 'WTW': None, 'TSN': 11.021702, 'ODFL': 35.134167, 'CERN': 54.794117, 'ANSS': 55.953365, 'DHI': 6.8816824, 'AWK': 34.983326, 'KHC': 21.638859, 'CPRT': 28.46988, 'SWK': 14.148882, 'ARE': 28.515505, 'LYB': 5.7607613, 'EFX': 36.970287, 'LH': 9.580303, 'EXR': 34.78362, 'EPAM': 58.899597, 'CDW': 23.975548, 'ZBH': 31.371998, 'VMC': 36.342266, 'NTRS': 17.996845, 'LEN': 5.7988787, 'RSG': 30.827177, 'MKC': 34.269505, 'TSCO': 24.737246, 'HIG': 11.585956, 'KEY': 9.620179, 'MLM': 31.55279, 'SYF': 5.913142, 'IT': 34.420563, 'CHD': 29.428003, 'MAA': 54.404346, 'MTB': 12.975046, 'HBAN': 17.19731, 'DTE': 26.014399, 'DOV': 23.880415, 'RF': 8.799176, 'URI': 18.242409, 'FTV': 13.661649, 'ZBRA': 25.602207, 'CFG': 10.418674, 'SWKS': 14.933667, 'HPE': 6.4437985, 'PKI': 17.442883, 'FE': 19.729124, 'STX': 15.4525385, 'STE': 81.99637, 'BBY': 8.604854, 'AEE': 21.858223, 'IR': 52.953396, 'PPL': None, 'ETR': 16.963911, 'VTR': 97.183365, 'SBNY': 24.058691, 'GWW': 26.544155, 'ESS': 45.866085, 'NTAP': 20.42305, 'VRSN': 37.513363, 'ULTA': 22.80587, 'RJF': 16.122171, 'ENPH': 110.4948, 'NDAQ': 24.499651, 'DRE': 21.449097, 'MPWR': 96.7926, 'TDY': 40.99004, 'FLT': 24.289698, 'WAT': 27.592743, 'COO': 6.719912, 'VFC': 18.341347, 'GNRC': 33.08636, 'TER': 21.056696, 'CINF': 7.8818417, 'TTWO': 32.88255, 'DRI': 19.945677, 'GPC': 21.265821, 'PFG': 11.19775, 'AMCR': 19.16804, 'WAB': 38.148613, 'CMS': 20.563475, 'OMC': 12.938474, 'IP': 9.951552, 'EXPD': 15.079906, 'CLX': 42.558407, 'VTRS': None, 'POOL': 28.309496, 'HOLX': 9.822469, 'TYL': 104.39477, 'KMX': 13.867613, 'BXP': 58.194717, 'CAG': 14.429666, 'PEAK': 26.9869, 'TRMB': 29.48111, 'GRMN': 18.750427, 'CE': 5.5868826, 'CNP': 16.859505, 'ETSY': 34.561924, 'AKAM': 27.12991, 'NVR': 15.054798, 'CTLT': 29.645891, 'EMN': 31.980677, 'BR': 30.307196, 'K': 18.132498, 'NLOK': 17.750668, 'XYL': 34.580227, 'DPZ': 30.92979, 'JBHT': 30.030159, 'DGX': 7.7844048, 'PAYC': 107.06101, 'TXT': 20.249998, 'J': 36.77409, 'TECH': 90.89347, 'FDS': 37.383667, 'BRO': 31.40068, 'FMC': 25.103962, 'AVY': 19.645224, 'SJM': 19.601883, 'TFX': 35.213253, 'QRVO': 13.544946, 'CRL': 36.914906, 'PWR': 25.746916, 'IEX': 32.96553, 'MAS': 30.279911, 'MKTX': 50.51847, 'IPG': 20.220215, 'LNT': 22.107342, 'AAP': 19.990833, 'PKG': 18.527576, 'EVRG': 15.740355, 'ATO': 20.611328, 'ABMD': 89.269264, 'SEDG': 88.207054, 'FOXA': 13.859026, 'BBWI': 8.72496, 'RHI': 24.692177, 'HWM': 51.225414, 'HRL': 28.789158, 'CMA': 11.612502, 'LKQ': 13.271245, 'LDOS': 16.75738, 'HAS': 28.09945, 'WHR': 6.181302, 'IRM': 19.17615, 'JKHY': 39.038822, 'BIO': 2.6023695, 'CBOE': 27.399618, 'CTXS': 40.460682, 'WRB': 16.07008, 'L': 9.754512, 'NDSN': 28.5646, 'PHM': 6.9156995, 'WRK': 14.376996, 'FBHS': 15.532483, 'LNC': 9.698795, 'XRAY': 29.069403, 'FFIV': 36.402622, 'CHRW': 16.345201, 'HSIC': 19.05759, 'SNA': 13.891354, 'PTC': 26.471462, 'ZION': 9.823396, 'JNPR': 73.76667, 'TPR': 13.40178, 'BWA': 13.184227, 'ALLE': 21.517893, 'UHS': 10.704338, 'REG': 33.64433, 'SEE': 22.797169, 'NWL': 17.29078, 'GL': 13.959376, 'LW': 37.805717, 'PNR': 18.483946, 'AOS': 23.474047, 'NRG': 3.6848435, 'OGN': 5.9389124, 'TAP': None, 'CPB': 14.295098, 'LUMN': None, 'NWSA': 25.740965, 'DISCK': 18.74582, 'BEN': 8.117647, 'MHK': 2.7794178, 'PENN': 20, 'DVA': 13.126242, 'PNW': 13.464208, 'IVZ': 8.34585, 'DISH': 6.6181774, 'HII': 11.2545, 'VNO': None, 'PVH': 13.881984, 'ROL': 42.8925, 'NLSN': 7.608795, 'FOX': 12.647059, 'IPGP': 27.692547, 'DISCA': 18.832777, 'UAA': 16.687832, 'UA': 14.640212, 'NWS': 26}
for i in list(PE.keys()):
    if PE[i] is None:
        PE.pop(i)
select = []
for i in list(PE.keys()):
    if PE[i] > 10 and PE[i] < 20:
        select.append(i)
PE_select = {}
for i in select:
    PE_select[i] = PE[i]
a = sorted(PE_select.items(), key=lambda x: x[1], reverse=True)

tech = []
with open("tech.csv")as f:
    f_csv = csv.reader(f)
    for row in f_csv:
        tech.append(row[0])
tech.remove(tech[0])

QEG = ['ABBV', 'DIS', 'BXP', 'HPE', 'LYB', 'NLSN', 'NUE', 'REG', 'IT', 'TSLA', 'FIS', 'WTW', 'GILD', 'DRE', 'ANTM', 'NRG', 'NDSN', 'O', 'AIG', 'NWSA', 'NWS', 'PFE', 'PTC', 'RTX', 'NLOK', 'NOW', 'VTR', 'EQR', 'SPG']
PEG = ['PFE', 'CTRA', 'LYB', 'BKR', 'WFC', 'COF', 'DOW', 'DFS', 'NUE', 'EOG', 'F', 'TJX', 'SYF', 'PXD', 'FANG', 'MAR', 'HLT', 'ROST', 'BKNG', 'LEN', 'RF', 'ULTA', 'HAL', 'DAL', 'AIG', 'MU', 'OXY']
PE = ['FB', 'HD', 'BAC', 'PFE', 'CSCO', 'WFC', 'VZ', 'CMCSA', 'QCOM', 'PM', 'LOW', 'MS', 'AMAT', 'AXP', 'IBM', 'ANTM', 'BLK', 'DE', 'CAT', 'MU', 'TGT', 'LMT', 'CB', 'MMM', 'PNC', 'TFC', 'LRCX', 'CSX', 'USB', 'GILD', 'CI', 'ICE', 'D', 'FCX', 'PGR', 'HCA', 'KLAC', 'EMR', 'FDX', 'GD', 'TEL', 'SPG', 'DG', 'BK', 'ADM', 'AEP', 'TRV', 'GIS', 'AZO', 'SIVB', 'STT', 'FITB', 'ROST', 'TROW', 'PCAR', 'CMI', 'WY', 'OKE', 'TSN', 'SWK', 'NTRS', 'HIG', 'MTB', 'HBAN', 'URI', 'FTV', 'CFG', 'SWKS', 'PKI', 'FE', 'STX', 'ETR', 'RJF', 'VFC', 'DRI', 'PFG', 'AMCR', 'OMC', 'EXPD', 'KMX', 'CAG', 'GRMN', 'CNP', 'NVR', 'K', 'NLOK', 'AVY', 'SJM', 'QRVO', 'AAP', 'PKG', 'EVRG', 'FOXA', 'CMA', 'LKQ', 'LDOS', 'IRM', 'WRB', 'WRK', 'FBHS', 'CHRW', 'HSIC', 'SNA', 'TPR', 'BWA', 'UHS', 'NWL', 'GL', 'PNR', 'CPB', 'DISCK', 'DVA', 'PNW', 'HII', 'PVH', 'FOX', 'DISCA', 'UAA', 'UA']
set1 = set(QEG)
set2 = set(PEG)
set3 = set(PE)
set4 = set(tech)
b = set1.union(set2).union(set3)
a = list(set4.intersection(b))